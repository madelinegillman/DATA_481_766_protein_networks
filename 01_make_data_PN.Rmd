```{r}
## Section 1: Describe the project  
# Decoding Protein Networks in Thousands of Single Cancer Cells  

# This project analyzes data obtained from iterative immunofluorescence, a technique that measures protein amounts and spatial locations within individual cells. By decoding complex protein interactions, we aim to gain insights into cellular behavior, particularly in cancer biology.

# The dataset used in this analysis was generated by the Brunk lab and the Pervis lab at UNC Chapel Hill.

## Section 2: What you hope to discover in your killer graph  
# By analyzing the relationship between the abundances of MYC and BRD4 within single cells, we aim to uncover:
# - Correlation between MYC and BRD4 levels.
# - How these interactions influence gene regulation and cellular behavior.
# - Patterns that provide insights into normal and cancerous cell processes.

## Section 3: Code and text to retrieve the data set  

# Load required libraries
library(tidyverse)

# Load the dataset
file_path <- "lung_cancer.csv"
df_cell <- read.csv(file_path, row.names = 1)

# Confirm successful loading
print("Dataset loaded successfully!")
head(df_cell)
```

```{r}
## Section 4: Verify dimensions and variables  
# Check the dimensions of the dataset
dim(df_cell)

# Display column names
colnames(df_cell)
```

```{r}
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(corrplot)
library(stats)

# Load the dataset
df_cell <- read_csv('lung_cancer.csv')

# 1. Correlation Analysis for Protein Expression
myc_brd4_corr <- cor(df_cell$`01_cMyc_nuc_mean`, df_cell$`01_BRD4_nuc_mean`)
cat("Correlation between nuclear MYC and BRD4:", myc_brd4_corr, "\n")

# Visualization of correlation matrix for selected proteins
selected_proteins <- c(
  '01_cMyc_nuc_mean', '01_BRD4_nuc_mean', 
  '02_HER2_nuc_mean', '06_AKT_nuc_mean'
)

correlation_matrix <- cor(df_cell[, selected_proteins])
png("correlation_plot.png")
corrplot(correlation_matrix, method = "circle")
dev.off()

# 2. HER2 Status Protein Expression Comparison
her2_median <- median(df_cell$`02_HER2_nuc_mean`)
high_her2_cells <- df_cell[df_cell$`02_HER2_nuc_mean` > her2_median, ]
low_her2_cells <- df_cell[df_cell$`02_HER2_nuc_mean` <= her2_median, ]

proteins_to_test <- c(
  '01_cMyc_nuc_mean', 
  '06_AKT_nuc_mean', 
  '09_mTOR_nuc_mean'
)

# Perform t-tests
for (protein in proteins_to_test) {
  t_test_result <- t.test(
    high_her2_cells[[protein]], 
    low_her2_cells[[protein]]
  )
  
  cat("T-test for", protein, ":\n")
  cat("t-statistic:", t_test_result$statistic, "\n")
  cat("p-value:", t_test_result$p.value, "\n\n")
}

# 3. Protein Localization Analysis
get_protein_columns <- function(df, protein_name) {
  nuc_cols <- grep(paste0(protein_name, "_nuc_mean"), names(df), value = TRUE)
  ring_cols <- grep(paste0(protein_name, "_ring_mean"), names(df), value = TRUE)
  list(nuc = nuc_cols, ring = ring_cols)
}

proteins_to_compare <- c('cMyc', 'BRD4', 'AKT')

localization_results <- list()

for (protein in proteins_to_compare) {
  cols <- get_protein_columns(df_cell, protein)
  nuc_levels <- rowMeans(df_cell[, cols$nuc])
  ring_levels <- rowMeans(df_cell[, cols$ring])
  
  # Paired t-test
  t_test_result <- t.test(nuc_levels, ring_levels, paired = TRUE)
  
  localization_results[[protein]] <- list(
    t_statistic = t_test_result$statistic,
    p_value = t_test_result$p.value
  )
}

# Print localization comparison results
for (protein in names(localization_results)) {
  cat(protein, "Nuclear vs. Cytoplasmic Comparison:\n")
  cat("t-statistic:", localization_results[[protein]]$t_statistic, "\n")
  cat("p-value:", localization_results[[protein]]$p_value, "\n\n")
}
```


### Our statistical analysis provides key insights into protein interactions in lung cancer cells. We found a moderate positive correlation (0.449) between nuclear MYC and BRD4, suggesting they often co-express and may be involved in coordinated cellular signaling. T-tests showed significant differences in cMyc, AKT, and mTOR levels between high and low HER2 cells, with extremely low p-values, indicating a strong link between these proteins and HER2 status. Additionally, cMyc localization varied significantly between the nucleus and cytoplasm, with a t-statistic of 13.070 and a p-value of 7.21e-39, highlighting notable differences in protein distribution. These findings emphasize the complex protein networks in cancer cells and their role in cellular signaling.
